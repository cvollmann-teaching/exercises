{
    "filename": "JacobiGaussSeidel-elementbased.tex",
    "title": "",
    "subtitle": "",
    "coding": "",
    "mathFields": "",
    "tags": "",
    "relatedExercises": "",
    "solutionLength": "",
    "task": "\\section{Weighted Jacobi, Gau\u00df--Seidel and Sucessive Over--Relaxation}\n\\textbf{\\color{solution}*9 Bonus points*}\\\\Let $A\\in \\Rnn$ be a matrix with nonzero diagonal entries $a_{ii}\\neq 0$ and consider the splitting $A=L+D+U$ into lower triangular, diagonal and upper triangular part of $A$. Also recall that splitting methods are of the form\n$$x^{k+1} = (I-NA)x^k + Nb, $$\nwhere the significant matrix $M:=I-NA$ is called iteration matrix.\\\\\n\nShow the following:\n\\begin{enumerate}\n\t\\item \\textbf{Weighted Jacobi:} $N=\\theta D^{-1}$\n\t\\begin{itemize}\n\t\t\\item For the iteration matrix we find\n\t\t$$M_{Jac} := I-\\theta D^{-1}A = (1-\\theta)I - \\theta D^{-1}(L+U) $$\n\t\t\\item The $i$-the component of $x^{k+1}=(I-NA)x^k + Nb$ is given by\n\t\t$$x^{k+1}_i = (1-\\theta)x_i^k +  \\frac{\\theta}{a_{ii}}\\left( b_i - \\sum_{j\\neq i} \\,a_{ij} \\, x_j^{k+1}\\right).$$\n\t\\end{itemize} \n\t\\item \\textbf{Gau\u00df--Seidel:} $N=(L+D)^{-1}$\n\t\t\\begin{itemize}\n\t\t\\item For the iteration matrix we find\n\t\t$$M_{GS} := I- (L+D)^{-1}A =-(L+D)^{-1}U$$\n\t\t\\item The $i$-the component of $x^{k+1}=(I-NA)x^k + Nb$ is given by\n\t\t$$x^{k+1}_i =  \\frac{1}{a_{ii}}\\left( b_i - \\sum\\limits^{i-1}_{j=1} \\,a_{ij} \\, x_j^{k+1} -  \\sum\\limits^n_{j = i+1} \\, a_{ij} \\, x^k_j  \\right).$$\n\t\\end{itemize} \n\t\\item \\textbf{Sucessive Over--Relaxation (variant of Gau\u00df-Seidel):}  $N=\\theta\\cdot(\\theta L+D)^{-1}$\n\t\t\\begin{itemize}\n\t\\item For the iteration matrix we find\n\t$$M_{SOR} :=I-\\theta( \\theta L+D )^{-1}A=(\\theta L +D)^{-1} ((1-\\theta)D-\\theta U).$$\n\t\t\\item  The $i$-the component of $x^{k+1}=(I-NA)x^k + Nb$ is given by\n\t$$ x^{k+1}_i = (1-\\theta)x_i^k+   \\frac{\\theta}{a_{ii}}\\left( b_i - \\sum\\limits^{i-1}_{j=1} \\,a_{ij} \\, x_j^{k+1} -  \\sum\\limits^n_{j = i+1} \\, a_{ij} \\, x^k_j  \\right).$$\n\t\\end{itemize}\n{\\color{navy}\\textit{Remark:} We observe that SOR for $\\theta = 1$ is Gau\u00df--Seidel and otherwise is a combination of the previous step $x^k$ and the Gau\u00df-Seidel update. For spd matrices it allows for $\\theta > 1$ which is why it is called over--relaxation.}\n\\end{enumerate}\n\\textit{Hint:} For 2. and 3. cast the formulas into the form $x^{k+1}=T^{-1}w$ for some lower triangular matrix $T$ and some vector $w$ and then use forward substitution.\\\\~\\\\\n%{\\color{navy}\\textit{Note:} If we use a relaxation parameter $\\theta\\neq 1$, we see in both methods that the new iterate is a combination of the old iterate $(1-\\theta)x^k$ and a new term $\\theta\\left(\\cdots\\right)$. For $\\theta = 1$ it is solely the new term. For $\\theta \\in (0,1)$ it is a convex combination.}\n",
    "solution": "{\\color{solution}\n{\\color{navy}\nWe first recall the forward substitution formula for inverting lower triangular matrices: Let $T = (\\ell_{ij})\\in\\Rnn$ be triangular and $w \\in \\Rn$, then the $i$-th component of $z=T^{-1}w$ is given by\n$$z_i =\\frac{1}{\\ell_{ii}}\\left(w_i-\\sum_{j=1}^{i-1}\\ell_{ij}z_j\\right),~~~i\\in\\{1,\\ldots,n\\}.$$\n\n}\n\\begin{enumerate}\n\t\\item \\textbf{Jacobi:}\n\t\\begin{itemize}\n\t\t\\item Using the splitting $A=L+D+U$ we find\n\t\t$$M_{Jac} := I-\\theta D^{-1}A = I-\\theta D^{-1}(L+D+U)=I-\\theta(I + D^{-1}(L+U))= (1-\\theta)I - \\theta D^{-1}(L+U)$$\n\t\t\\item The inverse of $D$ is $D^{-1}= \\text{diag}(\\frac{1}{a_{11}},\\ldots, \\frac{1}{a_{nn}})$. Thus the $i$-th component of $\\theta D^{-1} b$ is given by \n\t\t$\\theta \\frac{b_i}{a_{ii}} .$ \n\t\tNow applying the definition of the matrix vector product we find for the $i$-th component of $\\theta D^{-1}A x^k  $ that\n\t\t$\\theta \\frac{1}{a_{ii}} \\sum_{j=1}^n a_{ij}x^k_j $. Combining this we obtain for the $i$-th of the Jacobi iterate the searched formula\n\t\t\\begin{align*}\n\t\tx_{i}^{k+1}= x_i^k -\\theta \\frac{1}{a_{ii}} \\sum_{j=1}^n a_{ij}x^k_j  + \\theta \\frac{b_i}{a_{ii}}  \n\t\t&= x_i^k -\\theta x_i^k  -\\theta\\frac{1}{a_{ii}} \\sum_{j\\neq i}  a_{ij}x^k_j  + \\theta \\frac{b_i}{a_{ii}}\\\\\n\t\t&= (1-\\theta)x_i^k +  \\frac{\\theta}{a_{ii}}\\left( b_i - \\sum_{j\\neq i} \\,a_{ij} \\, x_j^{k+1}\\right).\n\t\t\\end{align*}\n\t\\end{itemize}\n\t\\item \\textbf{Gau\u00df--Seidel}\n\t\\begin{itemize}\n\t\t\\item Using the splitting $A=L+D+U$ we find\n\t\t$$M_{GS} := I- (L+D)^{-1}A = I- (L+D)^{-1}(L+D+U) =   I- (I+(L+D)^{-1} U)   =     -(L+D)^{-1}U$$\n\t\t\\item We cast the formula into a lower triangular system:\n\t\t\\begin{align*}\n\t\t x^{k+1} &=  (I-NA)x^k + Nb   =M_{GS}x^k + Nb\\\\\n\t\t & =-(L+D)^{-1}Ux^k + (L+D)^{-1}b\\\\\n\t\t & = (L+D)^{-1}(b-Ux^k)\n\t\t\\end{align*}\n\t\tNow we consider $z= x^{k+1}$, $T=(L+D)$ and $w = b-Ux^k$ and apply forward substitution to obtain\n\t\\begin{align*}\n\tx^{k+1}_i = z_i &=\\frac{1}{\\ell_{ii}}\\left(w_i-\\sum_{j=1}^{i-1}\\ell_{ij}z_j\\right),~~~i\\in\\{1,\\ldots,n\\} \\\\\n\t&=\\frac{1}{a_{ii}}\\left(b_i - \\sum_{j=i+1}^{n}a_{ij}x^{k}_j-\\sum_{j=1}^{i-1}a_{ij}x^{k+1}_j\\right),~~~i\\in\\{1,\\ldots,n\\}.\n\t\\end{align*}\n\t\\end{itemize}\n\t\\item \\textbf{SOR}\n\t\\begin{itemize}\n\t\t \\item We use \n\t\t $$N=\\theta\\cdot(\\theta L+D)^{-1} \n\t\t =\\left(\\tfrac{1}{\\theta}\\right)^{-1}( \\theta L+ D) ^{-1} \n\t\t =\\left(   L+ \\tfrac{1}{\\theta}D\\right)^{-1}$$ \n\t\t and the splitting\n\t\t $$A=L+D+U =L+D+U\\pm \\tfrac{1}{\\theta}D \n\t\t =  (L+ \\tfrac{1}{\\theta}D) + U + (1-\\tfrac{1}{\\theta})D.$$ \n\t\t Then we find\n\t    \\begin{align*}\n\t    M_{SOR} := I-NA &=  I - \\left(   L+ \\tfrac{1}{\\theta}D\\right)^{-1} \\left( (L+ \\tfrac{1}{\\theta}D) + U + (1-\\tfrac{1}{\\theta})D\\right)\\\\\n\t    &= - \\left(   L+ \\tfrac{1}{\\theta}D\\right)^{-1} \\left(U + (1-\\tfrac{1}{\\theta})D\\right)\\\\\n\t    &=\\left(   L+ \\tfrac{1}{\\theta}D\\right)^{-1} \\left( \\tfrac{1-\\theta}{\\theta}D - U\\right)\\\\\n\t    &=\\theta\\cdot(\\theta L+D)^{-1}  \\left( \\tfrac{1-\\theta}{\\theta}D - U\\right) \\\\\n\t    &= (\\theta L+D)^{-1}  \\left( (1-\\theta)D - \\theta U\\right) .\n\t    \\end{align*} \n\t    \\item We cast the formula into a lower triangular system:\n\t    \\begin{align*}\n\t    x^{k+1} &=  (I-NA)x^k + Nb   =M_{SOR}x^k + Nb\\\\\n\t    & = (\\theta L+D)^{-1}  \\left( (1-\\theta)D - \\theta U\\right) x^k + \\theta\\cdot(\\theta L+D)^{-1} b\\\\\n\t    & = (\\theta L+D)^{-1}(\\theta b-((1-\\theta)D - \\theta U) x^k)\n\t    \\end{align*}\n   \t\tNow we consider $z= x^{k+1}$, $T=(\\theta L+D)$ and $w = \\theta b- (1-\\theta)Dx^k - \\theta U  x^k$ and apply forward substitution to obtain\n\t    \\begin{align*}\n\t    x^{k+1}_i = z_i &=\\frac{1}{\\ell_{ii}}\\left(w_i-\\sum_{j=1}^{i-1}\\ell_{ij}z_j\\right),~~~i\\in\\{1,\\ldots,n\\} \\\\\n\t    &=\\frac{1}{a_{ii}}\\left(\\theta b_i - (1-\\theta)a_{ii}x_i^k - \\theta \\sum_{j=i+1}^{n}a_{ij}x^{k}_j-\\sum_{j=1}^{i-1}\\theta a_{ij}x^{k+1}_j\\right),~~~i\\in\\{1,\\ldots,n\\}\\\\\n\t    \t    &=(1-\\theta)x_i^k+   \\frac{\\theta}{a_{ii}}\\left( b_i-  \\sum\\limits^n_{j = i+1} a_{ij}x^k_j  - \\sum\\limits^{i-1}_{j=1} \\,a_{ij} \\, x_j^{k+1}  \\right),~~~i\\in\\{1,\\ldots,n\\}.\n\t    \\end{align*}\n\t\\end{itemize}\n\\end{enumerate}\n\n}\n",
    "id": ""
}