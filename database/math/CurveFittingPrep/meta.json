{
    "filename": "CurveFittingPrep.tex",
    "title": "",
    "subtitle": "",
    "coding": "",
    "mathFields": "",
    "tags": "",
    "relatedExercises": "",
    "solutionLength": "",
    "task": "\\textbf{Curve Fitting}\\\\\nAssume you were given the following data:\n\\begin{center}\n\t\\begin{tabular}{l|c c c}\n\tz&-1&0&1\\\\\n\t\\hline\n\ty&-1&3&1\n\\end{tabular}\n\\end{center}\n\n~\\\\\n\\begin{enumerate}\n\t\\item \\textbf{Polynomial Interpolation:}\\\\\n\tFind coefficients $c_i \\in \\R$ for the following parabola (polynomial of degree $2$)\n\t$$f(z) = c_0 + c_1z + c_2z^2,$$\n\tsuch that $f(z_i) = y_i$ for all three measurements $i=1,2,3$ from the table above. Therefore, set up and solve a linear system of the form $Ax = b$, where $x=(c_0, c_1, c_2)$. Draw the measurements and the parabola into one plot.\n\t~\\\\~\\\\\n\t\\item \\textbf{Univariate Linear Regression:}\\\\\n\tNow assume a linear model of the form\t\n\t$$f(z) = c_0 + c_1z.$$\n\tConsider $x = (c_0, c_1)$. Determine a matrix $A$ and a vector $b$, such that\n\t$$\\sum_{i=1}^3 (f(z_i) - y_i)^2 = \\|Ax-b\\|_2^2. $$\n\tSolve the least squares problem\n\t\t\\begin{align*}\n\t\\min \\limits_{x \\in \\mathbb{R}^2} \\|Ax-b\\|_2^2,\n\t\\end{align*}\n\tto determine the coefficients $x = (c_0, c_1)$ by solving the \\textit{normal equation} (explanation follows later in the lecture)\n\t$$A^TAx = A^Tb. $$\n\tDraw the measurements and the straight line into one plot.\n\\end{enumerate}\n",
    "solution": "{\n\t\\color{solution}\n\t\\begin{enumerate}\n\t\t\\item \\underline{INTERPOLATION:}\n\t\t\\begin{itemize}\n\t\t\t\\item \n\t\t\tAim: We want to find $c_0,c_1,c_2$, such that\\\\\n\t\t\t$f(z_1)=c_0\\cdot 1+c_1\\cdot z_1+c_2\\cdot z_1^2 = y_1$,\\\\\n\t\t\t$f(z_1)=c_0\\cdot 1+c_1\\cdot z_2+c_2\\cdot z_2^2 = y_2$,\\\\\n\t\t\t$f(z_1)=c_0\\cdot 1+c_1\\cdot z_3+c_2\\cdot z_3^2 = y_3$.\n\t\t\t\\item \n\t\t\tWith $A = (a_{ij})_{ij} := (z_i^{j-1})_{ij},~ x:= (c_0,c_1,c_2)^T,~b:= (y_1,y_2,y_3)^T$ this is equivalent to:\n\t\t\t$$\n\t\t\tAx = b.\n\t\t\t$$\n\t\t\t\\item \n\t\t\tInserting the data points $(z_i,y_i)$ gives: \n\t\t\t\\begin{align*} \n\t\t\tA = \\begin{array}{r}\n\t\t\t\\textcolor{violet}{\\text{(I)}}\\\\\n\t\t\t\\textcolor{violet}{\\text{(II)}}\\\\\n\t\t\t\\textcolor{violet}{\\text{(III)}}\n\t\t\t\\end{array}\n\t\t\t\\begin{pmatrix} \n\t\t\t1&-1&1\\\\\n\t\t\t1&0&0\\\\\n\t\t\t1&1&1\\end{pmatrix}, ~~\n\t\t\tb =\\begin{pmatrix} -1\\\\3\\\\1\\end{pmatrix}.\n\t\t\t\\end{align*}\n\t\t\t$\\textcolor{violet}{\\text{(II)}}\\Rightarrow x_1 = 3$\\\\\n\t\t\t$\\textcolor{violet}{\\text{(I)}}\\Rightarrow \\underbrace{x_1}_{\\textcolor{blue}{=3}}-x_2+x_3=-1 \\ \\ \\Leftrightarrow\\ \\ x_3=x_2-4$\\\\\n\t\t\t$\\textcolor{violet}{\\text{(III)}}\\Rightarrow \\underbrace{x_1}_{\\textcolor{blue}{=3}}+x_2+\\underbrace{x_3}_{\\textcolor{blue}{=x_2-4}} = 1\\ \\ \\Leftrightarrow\\ \\ x_2 = 1$\n\t\t\t\\item \n\t\t\tAll in all: $$x=\\begin{pmatrix} c_0\\\\c_1\\\\c_2\\end{pmatrix}\n\t\t\t=\\begin{pmatrix}3\\\\1\\\\-3\\end{pmatrix}.$$\n\t\t\t\\item \n\t\t\tThus, our fitting parabola is given by:\n\t\t\t$$\n\t\t\t\\textcolor{blue}{f(z)=3+z-3z^2}.\n\t\t\t$$\n\t\t\t\\includegraphics[width=0.5\\textwidth]{interpolation.pdf}\n\t\t\\end{itemize}\n\t\t\\item \\underline{LINEAR REGRESSION:}\n\t\t\\begin{itemize}\n\t\t\t\\item \n\t\t\tAim: Find $c_0,c_1$ such that\n\t\t\t$$\n\t\t\tf(z_i) = c_0+c_1z_i\\approx y_i~~ \\forall i=1,2,3.\n\t\t\t$$\n\t\t\t\\item \n\t\t\tAs above we define\n\t\t\t\\begin{align*}\n\t\t\t&A :=(a_{ij})_{ij}=(z_i^{j-1})_{ij}\n\t\t\t=\\begin{pmatrix}1&z_1\\\\1&z_2\\\\1&z_3\\end{pmatrix}\n\t\t\t=\\begin{pmatrix}1&-1\\\\1&0\\\\1&1\\end{pmatrix},\\\\\n\t\t\t&x:=\\begin{pmatrix}c_0\\\\c_1\\end{pmatrix},~~ b:=\\begin{pmatrix}y_1\\\\y_2\\\\y_3\\end{pmatrix}.\n\t\t\t\\end{align*}\n\t\t\t\\item Then by construction of $A, x$ and $b$ we find:\n\t\t\t$$\n\t\t\t\\|{Ax-b}\\|_2^2 = {\\Bigg\\Vert \\underbrace{\\begin{pmatrix}1&z_1\\\\1&z_2\\\\1&z_3\\end{pmatrix}\\begin{pmatrix}c_0\\\\c_1\\end{pmatrix}}_{\\textcolor{blue}{=\\begin{pmatrix}c_0+z_1c_1\\\\c_0+z_2c_1\\\\c_0+z_3c_1\\end{pmatrix}=\\begin{pmatrix}f(z_1)\\\\f(z_2)\\\\f(z_3)\\end{pmatrix}}}-\\begin{pmatrix}y_1\\\\y_2\\\\y_3\\end{pmatrix}}\\Bigg\\Vert_2^2=\\\\\n\t\t\t\\Bigg\\lVert{\\begin{pmatrix}f(z_1)-y_1\\\\f(z_2)-y_2\\\\f(z_3)-y_3\\end{pmatrix}}\\\\\n\t\t\t\\Bigg\\rVert_2^2\\stackrel{\\textcolor{blue}{\\text{Def. of}\\ \\|{\\cdot}\\|_2}}{=}\\sum_{i=1}^{3}(f(z_i)-y_i)^2.\n\t\t\t$$\n\t\t\t\\item \n\t\t\tWe now solve the $\\textcolor{red}{\\text{normal equation}}$ $$A^TAx = A^Tb$$\n\t\t\tto determine the solution of the least squares problem:\n\t\t\t$$\n\t\t\t\\min_{x=(c_0,c_1)\\in\\mathbb{R}^2} \\|{Ax-b}\\|_2^2 = \\min_{c_0,c_1}\\sum_{i=1}^{3}[(c_0+c_1z_i)-y_i]^2.\n\t\t\t$$\n\t\t\t\\item \n\t\t\tWe find\n\t\t\t\\begin{align*} \n\t\t\t&A^TA = \\begin{pmatrix}1&1&1\\\\-1&0&1\\end{pmatrix}\n\t\t\t\\begin{pmatrix}1&-1\\\\1&0\\\\1&1\\end{pmatrix} =\\begin{pmatrix}3&0\\\\0&2\\end{pmatrix},\\\\\n\t\t\t&A^Tb =\\begin{pmatrix}1&1&1\\\\-1&0&1\\end{pmatrix}\\begin{pmatrix}-1\\\\3\\\\1\\end{pmatrix}=\\begin{pmatrix}3\\\\2\\end{pmatrix}.\n\t\t\t\\end{align*}\n\t\t\t\\item \n\t\t\tThus:\n\t\t\t$$\n\t\t\tA^TAx = A^Tb~~\\Leftrightarrow~~ \\begin{pmatrix}3&0\\\\0&2\\end{pmatrix}\n\t\t\t\\begin{pmatrix}c_0\\\\c_1\\end{pmatrix}\n\t\t\t=\\begin{pmatrix}3\\\\2\\end{pmatrix}~~ \\Leftrightarrow~~ \\begin{matrix}c_0=1\\\\c_1=1\\end{matrix}.$$\n\t\t\t\\item \n\t\t\tTherefore the best linear fit in the least squares sense is given by\n\t\t\t$$\n\t\t\t\\textcolor{violet}{g(z) = 1+z}.\n\t\t\t$$\n\t\t\t\\includegraphics[width=0.5\\textwidth]{regression.pdf}\n\t\t\\end{itemize}\n\t\\end{enumerate}\n}",
    "id": ""
}