{
    "filename": "LeastSquaresMinNorm.tex",
    "title": "",
    "subtitle": "",
    "coding": "",
    "mathFields": "",
    "tags": "",
    "relatedExercises": "",
    "solutionLength": "",
    "task": "\\section{Minimum Norm Least Squares Solution: Example}\n\n\nLet $b \\in \\mathbb{R}^m$ and $A \\in \\mathbb{R}^{m \\times n}$.\nAssume you are given the least squares problem \n$$\n\\min\\limits_{x \\in \\mathbb{R}^n} \\| Ax-b \\|_2^2.\n$$\n\\begin{enumerate}\n\t\\item Which equation does a solution $\\hat{x}$ of the above least squares problem solve? Give formula and name of the equation.\n\t\\item Assume you are given the following data\n\t\\begin{center}\n\t\t\\begin{tabular}{l|cc}\n\t\t\tz&-1&1\\\\\n\t\t\t\\hline\n\t\t\ty&2&-1\n\t\t\\end{tabular}\n\t\\end{center}\n which you want to explain by a model $f:\\mathbb{R} \\to \\mathbb{R}$ of the form \n\t$$f_c(z) = c_0 + c_1z + c_2z^2.$$\n\tSolve the least squares problem\n\t$$\n\t\\min\\limits_{c \\in \\mathbb{R}^3} \\sum_{i=1}^2 (f_c(z_i) - y_i)^2\n\t$$\n\tto determine appropriate coefficients $(c_0, c_1, c_2)$. If there are infinitely many solutions, pick the one with minimal norm.\\\\~\\\\\n\t\\textit{Hint:} Characterize the solution set $\\hat{S}$ and derive a formula for the norm of a solution. Then use the fact, that the minimum (or maximum) of a quadratic function $p\\colon\\mathbb{R} \\to \\mathbb{R}$, $p(s)= a_0+a_1s+a_2s^2$ can be found by setting the first derivative to zero, i.e., $0=p'(s)=a_1+2a_2 s$.\n\\end{enumerate} ",
    "solution": "{\n\\color{solution}\n\\begin{enumerate}\n\t\\item \n\t$\\hat{x}$ solves the normal equation $A^TA\\hat{x}=A^Tb$.\n\t\\item \n\tWe define \n\t\\begin{align*}\n\t&A:=\\begin{pmatrix} z_1^0&z_1^1&z_1^2\\\\z_2^0&z_2^1&z_2^2\\end{pmatrix}=\\begin{pmatrix}1&-1&1\\\\1&1&1\\end{pmatrix},~~ b:=\\begin{pmatrix}y_1\\\\y_2\\end{pmatrix}=\\begin{pmatrix}2\\\\-1\\end{pmatrix},\\\\\n\t&x=(c_0,c_1,c_2).\n\t\\end{align*}\n\tThen: \n\t$$\n\t\\min_{c\\in\\mathbb{R}^3} \\sum_{i=1}^{2} (f_c(z_i)-y_i)^2\\ \\ =\\ \\ \\min_{x\\in\\mathbb{R}^3} \\|{Ax-b}\\|_2^2.\n\t$$\n\tThus we can equivalently solve the normal equation: \n\t\\begin{align*} \n\tA^TAx = A^Tb &\\Leftrightarrow \\underbrace{\\begin{pmatrix}1&1\\\\-1&1\\\\1&1\\end{pmatrix}\\begin{pmatrix}1&-1&1\\\\1&1&1\\end{pmatrix}}_{\\textcolor{blue}{=\\begin{pmatrix}2&0&2\\\\0&2&0\\\\2&0&2\\end{pmatrix}}}x =\\underbrace{\\begin{pmatrix}1&1\\\\-1&1\\\\1&1\\end{pmatrix}\\begin{pmatrix}2\\\\-1\\end{pmatrix}}_{\\textcolor{blue}{=\\begin{pmatrix}1\\\\-3\\\\1\\end{pmatrix}}}\\\\\n\t&\\Leftrightarrow \\begin{pmatrix}2&0&2\\\\0&2&0\\\\2&0&2\\end{pmatrix}\\begin{pmatrix}x_1\\\\x_2\\\\x_3\\end{pmatrix}=\\begin{pmatrix}1\\\\-3\\\\1\\end{pmatrix}\n\t\\textcolor{violet}{\\begin{matrix}(\\text{I})\\\\ (\\text{II})\\\\ (\\text{III})\\end{matrix}}\\\\&\\begin{matrix}\\textcolor{violet}{(\\text{I})'\n\t=\\frac{1}{2}(\\text{I})}\\\\ \\textcolor{violet}{(\\text{II})'=\\frac{1}{2}(\\text{II})}\\\\ \\textcolor{violet}{(\\text{III})'=(\\text{III})-(\\text{I})}\\end{matrix} \\Leftrightarrow\n\t\\begin{pmatrix}1&0&1\\\\0&1&0\\\\0&0&0\\end{pmatrix}\n\t\\begin{pmatrix}x_1\\\\x_2\\\\x_3\\end{pmatrix}\n\t=\\begin{pmatrix}\\frac{1}{2}\\\\ -\\frac{3}{2}\\\\0\\end{pmatrix}\\\\\n\t&\\textcolor{violet}{(\\text{I})'}\\Rightarrow x_1+x_3=\\frac{1}{2}\\Leftrightarrow x_3=\\frac{1}{2}-x_1\\\\\n\t& \\textcolor{violet}{(\\text{II})'}\\Rightarrow x_2=-\\frac{3}{2}.\n\t\\end{align*}\n\tThus the solution set is given by \n\t$$\n\t\\hat{S}:=\\{x\\in\\mathbb{R}^3:A^TAx=A^Tb\\}=\\begin{Bmatrix}\\begin{pmatrix}s\\\\-\\frac{3}{2}\\\\\\frac{1}{2}-s\\end{pmatrix}:s\\in\\mathbb{R}\\end{Bmatrix}.\n\t$$\n\tWe now determine the solution with minimal norm:\n\t\\begin{enumerate}\n\t\t\\item \n\t\tFor an arbitrary solution $x_s:=\\begin{pmatrix}s\\\\-\\frac{3}{2}\\\\\\frac{1}{2}-s\\end{pmatrix}$ for some $s\\in\\mathbb{R}$ we find: \n\t\t\\begin{align*} p(s):= \\|{x_s}\\|_2^2 =s^2+\\frac{9}{4}+\\left(\\frac{1}{2}-s\\right)^2\n\t\t=s^2+\\frac{9}{4}+\\frac{1}{4}-s+s^2\n\t\t=\\frac{5}{2}-s+2s^2.\n\t\t\\end{align*}\n\t\t\\item \n\t\tWe determine the parameter $s\\in\\mathbb{R}$ for which $\\|{x_s}\\|_2^2$ is minimal: $$0\\stackrel{!}{=} p'(s)=-1+4s\\ \\ \\Leftrightarrow\\ \\ s=\\frac{1}{4}.\n\t\t$$\n\t\t\\item \n\t\tThe minimum norm solution is therefore given by $$\n\t\tx_{s=\\frac{1}{4}}=\\begin{pmatrix}\\frac{1}{4}\\\\-\\frac{3}{2}\\\\\\frac{1}{2}-\\frac{1}{4}\\end{pmatrix}=\\begin{pmatrix}0.25\\\\-1.5\\\\0.25\\end{pmatrix}.\n\t\t$$\n\t\\end{enumerate}\n\tThe model function corresponding to the minimum norm solution is then given by \n\t$$\n\tf_c(z)=0.25-1.5z+0.25z^2.\n\t$$\n\\end{enumerate}\n}",
    "id": ""
}