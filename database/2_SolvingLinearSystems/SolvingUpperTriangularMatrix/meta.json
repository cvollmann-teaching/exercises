{
    "filename": "SolvingUpperTriangularMatrix.tex",
    "title": "",
    "subtitle": "",
    "coding": "",
    "mathFields": "",
    "tags": "Linear Systems, Factor and Solve",
    "relatedExercises": "",
    "solutionLength": "",
    "task": "\\textbf{Solving Linear Systems with Triangular Matrices: Forward/Backward Substitution}\n\nLet $U = (u_{ij})_{ij} \\in \\mathbb{R}^{n \\times n}$ be an upper triangular matrix, i.e., $u_{ij} = 0$ for $i > j$, so that $U$ has the form\n\t$$ U = \\begin{pmatrix}\nu_{11} & u_{12} & \\cdots & u_{1n} \\\\\n0& u_{22} & & \\vdots \\\\\n\\vdots & & \\ddots & u_{n-1,n}\\\\\n0 & \\cdots &0 & u_{nn}\n\\end{pmatrix}.$$\n\\begin{enumerate}\n\t\\item Solve the following linear system by hand:\n\t\t$$\\begin{pmatrix}\n\t\t1 & -1 & 1\t\\\\\n\t\t0 & 2 & 1  \\\\\n\t\t0 & 0 & \\frac{1}{2}\t\n\t\t\\end{pmatrix} \\begin{pmatrix}\n\t\tx_1\\\\x_2\\\\x_3\n\t\t\\end{pmatrix} =\n\t\t\\begin{pmatrix}\n\t\t3\\\\0\\\\1\n\t\t\\end{pmatrix}.$$\n\t\tDo you observe an iterative pattern?\\\\\n\t\t\\textit{Hint:} Start with the last equation/row.\n\t\\item Let $b \\in \\mathbb{R}^n$ be a given vector. Then derive a general (iterative) formula to obtain $x \\in \\mathbb{R}^n $, which solves\n\t$$Ux = b.$$\n\tWhat requirements have to be put on the diagonal entries $u_{ii}$ of $U$, so that the system has a unique solution?\\\\\n\t\\textit{Hint:} Write out the system as\n\t$$\\begin{pmatrix}\n\tu_{11} & u_{12} & \\cdots & u_{1n} \\\\\n\t0& u_{22} & & \\vdots \\\\\n\t\\vdots & & \\ddots & u_{n-1,n}\\\\\n\t0 & \\cdots &0 & u_{nn}\n\t\\end{pmatrix}\\begin{pmatrix}\n\tx_1 \\\\x_2\\\\\\vdots \\\\x_{n-1}\\\\x_n\n\t\\end{pmatrix} = \\begin{pmatrix}\n\tb_1 \\\\b_2\\\\\\vdots\\\\ b_{n-1}\\\\b_n\n\t\\end{pmatrix}$$\n\tand start with the last row to determine $x_n$. Then use $x_n$ to determine $x_{n-1}$ from the second but last row. Continue this procedure until you reach the first row to determine $x_1$ with the help of the previously determined values $x_2, \\ldots, x_n$.\n\t\t\\item Find a similar formula for lower triangular matrices $L = (\\ell_{ij})_{ij} \\in \\mathbb{R}^{n \\times n}$, for which $\\ell_{ij} = 0$ for $i < j$.\n\\end{enumerate}\n~\\\\\n\\textit{Remark:} A diagonal matrix is a special case of a triangular matrix.",
    "solution": "{\n\\color{solution}\n\\begin{enumerate}\n\t\\item  \n\t\\begin{align*}\n\t\\textcolor{violet}{\\begin{array}{r}(\\text{I})\\\\(\\text{II})\\\\(\\text{III})\\end{array}}\n\t\\begin{pmatrix}1&-1&1\\\\0&2&1\\\\0&0&\\frac{1}{2}\\end{pmatrix}\\begin{pmatrix}x_1\\\\x_2\\\\x_3\\end{pmatrix}=\\begin{pmatrix}3\\\\0\\\\1\\end{pmatrix}\n\t\\end{align*}\n\t\\begin{align*}\n\t\\textcolor{violet}{(\\text{III})}~~~&\\Rightarrow~~~ \\frac{1}{2}x_3=1~~~\\Rightarrow~~~ x_3=2\\\\\n\t\\textcolor{violet}{(\\text{II})}~~~&\\Rightarrow~~~2x_2+x_3 = 0~~~\\Rightarrow~~~ x_2 = -1\\\\\n\t\\textcolor{violet}{(\\text{I})}~~~&\\Rightarrow~~~x_1 -x_2+x_3 = 3~~~\\Rightarrow~~~ x_1 = 0\n\t\\end{align*}\n\t\\begin{align*}\n\t\\Rightarrow\\ \\ \\ x=\\begin{pmatrix}0\\\\-1\\\\2\\end{pmatrix}\n\t\\end{align*}\n\t\\item First note that a triangular matrix is invertible if and only if the diagonal entries are nonzero (see the formula below or note that $\\text{det}(U)=\\prod_i u_{ii}$). \n\tNow, from considering the i-th row (equation)\n\t$$\n\tu_{ii}x_i + u_{i,i+1}x_{i+1}+\\dots+u_{in}x_n = b_i,\n\t$$\n\twe obtain a representation for $x_i$ given by\n\t\\begin{align*}\n\tx_n &= \\frac{b_n}{x_n}\\\\\n\t x_i &= \\underbrace{\\frac{1}{u_{ii}}}_{\\textcolor{blue}{[\\text{assume}~~ u_{ii}\\neq 0 ]}}\\left(b_i-\\sum_{j=i+1}^{n}u_{ij}x_j\\right), ~~~\\text{for}~ i<n,\n\t\\end{align*}\n\twhere all the $x_j$ for $ j\\in\\{i+1,\\dots,n\\}$ in the sum are computed in previous steps.\t\n\t\\item In the same way, by simply changing the indices in the sum, we find a formula for lower triangular matrices given by \n\\begin{align*}\nx_1 &= \\frac{b_1}{x_1}\\\\\nx_i &=\n  \\underbrace{\\frac{1}{\\ell_{ii}}}_{\\textcolor{blue}{[\\text{assume}~~ \\ell_{ii}\\neq 0 ]}}\\left(b_i-\\sum_{j=1}^{i-1}\\ell_{ij}x_j\\right),~~~\\text{for}~ i>1,\\\\\n\\end{align*}\n\twhere the $x_j$ for $j \\in \\{1,\\ldots, i-1\\}$ in the sum are determined in previous steps.\n\\end{enumerate}\n}",
    "id": ""
}